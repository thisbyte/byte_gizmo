import{r as u,j as a,b as f,d as m}from"./vendor-D-kv4W3J.js";import{u as g,P as h,M as s,T as x,C as y}from"./three-DoERBFDw.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const e of n.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&c(e)}).observe(document,{childList:!0,subtree:!0});function i(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(r){if(r.ep)return;r.ep=!0;const n=i(r);fetch(r.href,n)}})();const p=()=>!window.invokeNative,z=()=>{},j=(t,o)=>t>0&&t<90?o:t>-180&&t<-90||t>0?-o:o,l=(t,o)=>{const i=u.useRef(z);u.useEffect(()=>{i.current=o},[o]),u.useEffect(()=>{const c=r=>{const{action:n,data:e}=r.data;i.current&&n===t&&i.current(e)};return window.addEventListener("message",c),()=>window.removeEventListener("message",c)},[t])};async function R(t,o,i){if(p())return await new Promise(n=>n);const c={method:"post",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(o)};return await(await fetch(`https://byte_gizmo/${t}`,c)).json()}const T=()=>{const{camera:t}=g();return l("SetCameraPosition",({position:o,rotation:i})=>{t.position.set(o.x,o.z,-o.y),t.rotation.order="YZX",i&&t.rotation.set(s.degToRad(i.x),s.degToRad(j(i.x,i.z)),s.degToRad(i.y)),t.updateProjectionMatrix()}),a.jsx(h,{position:[0,0,10],makeDefault:!0,onUpdate:o=>o.updateProjectionMatrix()})},v=()=>{const t=u.useRef(null),[o,i]=u.useState(),[c,r]=u.useState("translate"),n=async()=>{const e={handle:o,position:{x:t.current.position.x,y:-t.current.position.z,z:t.current.position.y-.5},rotation:{x:s.radToDeg(t.current.rotation.x),y:s.radToDeg(-t.current.rotation.z),z:s.radToDeg(t.current.rotation.y)}},d=await R("UpdateEntity",e);(d==null?void 0:d.status)!=="ok"&&(t.current.position.set(d.position.x,d.position.z+.5,-d.position.y),t.current.rotation.order="YZX",t.current.rotation.set(s.degToRad(d.rotation.x),s.degToRad(d.rotation.z),s.degToRad(d.rotation.y)))};return l("SetupGizmo",e=>{i(e.handle),e.handle&&(t.current.position.set(e.position.x,e.position.z+.5,-e.position.y),t.current.rotation.order="YZX",t.current.rotation.set(s.degToRad(e.rotation.x),s.degToRad(e.rotation.z),s.degToRad(e.rotation.y)),e.gizmoMode&&r(e.gizmoMode))}),l("UpdateGizmo",e=>{t.current.position.set(e.position.x,e.position.z+.5,-e.position.y),t.current.rotation.order="YZX",t.current.rotation.set(s.degToRad(e.rotation.x),s.degToRad(e.rotation.z),s.degToRad(-e.rotation.y))}),l("SetGizmoMode",e=>{r(e)}),a.jsx(a.Fragment,{children:a.jsxs(u.Suspense,{fallback:a.jsx("p",{children:"Loading..."}),children:[o!=null&&a.jsx(x,{size:.5,object:t,mode:c,onObjectChange:n}),a.jsx("mesh",{ref:t})]})})},w=()=>a.jsxs(y,{style:{zIndex:1},children:[a.jsx(T,{}),a.jsx(v,{})]});function E(){return a.jsx("div",{style:{width:"100vw",height:"100vh"},children:a.jsx(w,{})})}f.createRoot(document.getElementById("root")).render(a.jsx(m.StrictMode,{children:a.jsx(E,{})}));if(p()){const t=document.getElementById("root");t.style.backgroundImage='url("https://i.imgur.com/3pzRj9n.png")',t.style.backgroundSize="cover",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center"}
